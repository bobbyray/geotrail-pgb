<!DOCTYPE html>
<!--  
Copyright (c) 2015 - 2017 Robert R Schomburg
Licensed under terms of the MIT License, which is given at
https://github.com/bobbyray/MitLicense/releases/tag/v1.0
-->
<html style="height: 100%">
<head>
    <title>GeoTrail</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none';
          script-src 'self' 'unsafe-eval' 'unsafe-inline' http://cdn.leafletjs.com;
          connect-src 'self' https://www.wigo.ws;
          img-src *;
          style-src 'self' 'unsafe-inline' http://cdn.leafletjs.com;
          frame-src 'self' gap:;">

    <script charset="utf-8" src="cordova.js"></script>

    <link rel="stylesheet" href="leaflet-0.7.3/leaflet.css" /> 
    <link rel="stylesheet" href="css/ws.wigo.cordovacontrols.css"> 
    <link rel="stylesheet" href="css/trail2.css"> 
    <!-- NotNeeded <link rel="stylesheet" href="css/iphone.css"> -->
    
    <!-- 20150617 moved to here from bottom of body section. Kind of doubt this is necessary. -->
    <!-- Javascript for this page.-->
    <!-- Open Streets Map
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    -->
    <script src="leaflet-0.7.3/leaflet.js"></script>  
    <script src="js/leaflet-tilelayer-cordova.js"></script>
    <script src="js/Helper2.js"></script>
    <script src="js/Ajax2.js"></script>
    <script src="js/GeoPathsApi2.js"></script>
    <!-- Google hosted jquery
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    -->
    <!-- local jquery -->
    <script src="js/jquery-1.11.3.js"></script>
    <script src="js/ws.wigo.networkinfo.js"></script>
    <script src="js/Model2.js"></script>
    <script src="js/oms.min.js"></script>  
    <script src="js/AnimatedMarker.js"></script>
    <script src="js/GeoPathMapView2.js"></script>
    <script charset="utf-8" src="js/PebbleAdapter.js"></script> 
    <script src="jsAuthCordova/FbAuthentication2.js"></script>
    <script src="js/ws.wigo.cordovacontrols.js"></script>
    <script src="js/devicedetails.js"></script>
    <script src="js/Trail2.js"></script>
</head>
<body>
    <div id="divMode">  
        <div id="titleHolder" class="wigo_ws_Bar">
            <div id="mainMenu"></div> <!-- Container for id="mainMenuDropDown" mainMenu  wigo_ws DropDownControl -->
            <span id="spanTitle" class="wigo_ws_Title"></span>
            <span id= "spanHelp" class="wigo_ws_TitleBarHelp">?</span>
            <div id="selectMode"></div><!-- Container for id="" selectMode wigo_ws DropDownControl. -->
        </div>

        <div id="divStatus"></div> <!-- container for StatusDiv ctrl. -->  
        <!-- buInitView is commented out except if debugging map view initialization. 
        <button id="buInitView" value="InitView">Init View</button>
         -->    
        <div id="divOwnerId" class="wigo_ws_Bar">
            <label id="labelSignIn" for="txbxOwnerName">User </label>
            <input id="txbxOwnerName" type="text" disabled: disabled/>
            <div id='selectSignInHolder'></div>
        </div>

        <div id="onlineOfflineEditBar" class="wigo_ws_Bar wigo_ws_NoShow">
            <div id="divTrailInfo">
                <!-- Container for id="selectGeoTrailDropDown" selectGeoTrail, a wigo_ws DropDownControl. -->
            </div>
            <div id="onlineOfflineEditAction">
                <div id="onlineAction" class="wigo_ws_NoShow"> <!-- Show onlineAction, or offlineAction exclusively -->
                    <input id="onlineSaveOffline" type="button" value="Save Offline" />
                    <div id="onlineSelectFind">
                        <!-- Container for dropdown list control with id="onlineSelectFindDropDown" for Find trails -->
                    </div>
                    <div id="onlineRecord">
                        <!-- Container for dropdown list control with id="onlineRecordDropDown" -->
                    </div>
                </div>
                <div id="offlineAction" class="wigo_ws_NoShow"> 
                    <!-- moved to mapBar 
                    <input id="offlineMyLoc" type="button" value="MyLoc"/>
                    -->
                    <div id="selectMapCache">
                        <!-- Container for id="selectMapCacheDropDown" wigo_ws DropDownControl. -->
                    </div>
                    <div id="offlineRecord">
                        <!-- Container for dropdown list control with id="offlineRecordDropDown" -->
                    </div>
                    <div id="offlineLocalData">
                        <!-- Container for dropdow list control with id='offlineLocalDataDropDown' -->
                    </div>
                </div>
            </div>
        </div>

        <div id="pathDescrBar" class="wigo_ws_Bar wigo_ws_NoShow"> 
            <div id=labelPathName>Trail Name</div>
            <div id="editAction" >
                <input id="buUpload" type="button" value="Upload"/> 
                <input id="buDelete" type="button" value="Delete"/> 
                <input id="buCancel" type="button" value="Cancel"/> 
                <div id="recordShare" class="wigo_ws_NoShow"> 
                    <!-- container for dropdown list for record trail share options, selectRecordShareDropDown -->
                </div>
            </div>
            <div id="divPathName">
                <input id="txbxPathName" type="text" /> <!-- pattern does not work: pattern="[a-zA-Z0-9]+" title="Use alpha numberic" -->  
            </div>
        </div>

        <div id="editDefineBar2" class="wigo_ws_NoShow">
            <div id="editDefineShare"> 
                <!-- Container for dropdown list for Share options, selectShareDropDown -->
            </div>
            <div id="editDefinePtAction">
                <!-- Container for dropdown list for PtAction, selectPtActionDropDown -->
            </div>
        </div>

        <div id="editDefineCursorsBar" class="wigo_ws_NoShow">
            <div id="divCursors">    <!-- Select divCurCursors or divPathIx exclusively -->
                <div id="divCursorLeft">
                    <input id="buCursorLeft" type="button" value="<"/>
                </div>
                <div id="divCursorCenter">
                    <input id="buCursorDown" type="button" value="V" />
                    <input id="buCursorUp" type="button" value="A" />
                </div>
                <div id="divCursorRight">
                    <input id="buCursorRight" type="button" value=">" />
                    <input id="buPtDo" type="button" value="OK" />
                </div>
            </div>
            <div id="divPathIx">
                <input id="buPathIxPrev" type="button" value="Prev" />
                <input id="buPathIxNext" type="button" value="Next" />
                <input id="buPtDeleteDo" type="button" value="OK" />
            </div>
        </div>
    </div>
    <div id="mapBar" class="wigo_ws_Bar wigo_ws_NoShow">
        <div id="mapBarBtns">
            <input id="mapGoToPath" type="button" title="Center Geo Trail" value="Ctr Trail" />
            <input id="mapGeoLocate" type="button" title="Get My Geo Location" value="MyLoc" />
        </div>
        <div id="mapPhAlertToggle"></div> <!-- Container for Cordova OnOffControl -->
        <div id="mapTrackToggle"></div> <!-- Container for Cordova OnOffControl -->
    </div>
    <div id="closeDialogBar" class="wigo_ws_Bar wigo_ws_NoShow">
        <button id=buCloseDialogBar>Close</button>
    </div>

    <div id="confirmDialogBar" class="wigo_ws_Bar wigo_ws_NoShow">
        <button id=buAcceptConfirmDialogBar>Accept</button>
        <button id='buRejectConfirmDialogBar'>Reject</button>
    </div>

    <!-- Settings, only shown when selected from mainMenu -->
    <div id="divSettings">
        <div id='divSettingsTitle'>
           <span id='spanSettingsTitle'>Settings for GeoTrail</span>
           <span> ...scroll...</span>
        </div>
        <div id='divSettingsScroll'>
            <div id='holderAllowGeoTracking' class='settingItem'>
            </div>
            <div id='holderOffPathUpdateMeters' class='settingItem'>
            </div>
            <div id='holderGeoTrackingSecs' class='settingItem'>
            </div>
            <div id='holderOffPathThresMeters' class='settingItem'>
            </div>
            <div id='holderDistanceUnits' class='settingItem'>
            </div>
            <div id='holderPhoneAlert' class='settingItem'>
            </div>
            <div id='holderOffPathAlert' class='settingItem'> 
            </div>
            <div id='holderPhoneVibeSecs' class='settingItem'>
            </div>
            <div id='holderPhoneBeepCount' class='settingItem'>
            </div>
            <div id='holderRecordDistanceAlert' class='settingItem'>
                <label id='labelRecordDistanceAlert'>Record Dist Alert (miles)</label>
                <input id='numberRecordDistanceAlert' type='number' step='.5' min='0.0' max='100.0 value='0.5' tabindex='-1'/>
            </div>
            <div id='holderAutoPathAnimation' class='settingItem'>
            </div>
            <div id='holderPebbleAlert' class='settingItem'>
            </div>
            <div id='holderPebbleVibeCount' class='settingItem'>
            </div>    
            <div id='holderPrevGeoLocThresMeters' class='settingItem'>
            </div>
            <div id='holderSpuriousVLimit' class='settingItem'>
            </div>
            <div id='holderBodyMass' class='settingItem'>
                <label id='labelBodyMass'>Body Weight (lbs)</label>
                <input id='numberBodyMass' tabindex='-1' type='number' step='5' min='100' max='250' value='150'/> 
            </div>
            <div id='holderCCE'>  
              <div id='divCCEContent'> 
                <div id='divCCEItem' class='settingItem wigo_ws_Show'>
                    <label >Calorie Conversion Efficiency</label>
                    <label id='labelCCEValue' class='cceValueLabel'></label>  
                    <button id='buCCESet'>Set</button>
                </div>
                <div id='divCCEUpdate' class='wigo_ws_NoShow'> 
                    <div id='divCCEUpdateCtrls'> 
                        <span id='spanCCEUpdateTitle'>Setting Calorie Conversion Efficiency</span><br/>
                        <div class='cceRow'>
                            <label class='cceLabel'>Distance</label><label id='cceDistance' class='cceValueLabel'></label>
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>Time</label><label id='cceTime' class='cceValueLabel'></label>     
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>Speed</label><label id='cceSpeed' class='cceValueLabel'></label>
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>Kinetic Calories</label><label id='cceKineticCalories' class='cceValueLabel'></label>
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>Estimated Calories</label><label id='cceCaloriesBurned' class='cceValueLabel'></label>
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>Actual Calories</label><input id='cceActualCalories' type='number' value='0'/>
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>New Efficiency %age</label><input id='cceNewEfficiency' type='number' value='0'/> 
                        </div>
                        <div class='cceRow'>
                            <label class='cceLabel'>Current Efficiency %age</label><label id='cceCurEfficiency' class='cceValueLabel'></label>
                        </div>
                        <div class='cceRow'>
                            <button id='buCCEApply'>Apply</button> <button id='buCCECancel'>Cancel</button>
                        </div>
                    </div>
                    <div id='divCCEUpdateNote'> 
                        <b>Note: </b>When a trail has been recorded, the time, distance, and speed you traveled are shown above.
                        Google for a "calories burned calculator" to find a calculator for the actual calories
                        you have burned. 
                        The time, distance, and speed are typically needed when using the calculator you found along with 
                        other factors such as your height, weight, age, and kind of activity.
                        Enter the result given by the calculator as the Actual Calories.
                        The new calorie conversion efficiency is determined and shown as the New Efficiency.
                        <p>Touch the Apply button to accept the New Efficiency.</p>
                        <p>Touch Cancel to not change the efficiency.</p>
                        <p>Instead, you can set the New Efficiency directly. If there is no recorded trail, the
                        only option is to set the New Efficiency.
                        </p>
                        <p>Kinetic Calories give the calculated kinetic energy in calories to move your body mass along the recorded trail.</p>
                        <p>Estimated Calories are the estimated calories you burned to move along the recorded trail:<br/>
                        Estimated Calories =  Kinetic Calories / Current Efficiency.</p>
                        <p>Calories are in units of US Food Calories:<br/>1 US Food Calorie = 4.184 kiloJoules.</p>
                        <br/>
                    </div>
                </div>
              </div>  
            </div>
            <div id='holderCompassHeadingVisible' class='settingItem'> 
            </div>
            <div id='holderClickForGeoLoc' class='settingItem'>
            </div>
            <!-- Settings for home area -->
            <div id='divHomeArea' class='settingItem'>
                <div id='divHomeAreaSW' class='settingItem'>
                    <label id="labelHomeAreaSW"  for="numberHomeAreaSWLat">Home Area SW Corner</label>
                    <input id="numberHomeAreaSWLat"  type="number" disabled="disabled" />
                    <input id="numberHomeAreaSWLon"  type="number" disabled="disabled" /><br />
                </div>
                <div id='divHomeAreaNE' class='settingItem'>
                    <label id="labelHomeAreaNE"  for="numberHomeAreaNELat">Home Area NE Corner</label>
                    <input id="numberHomeAreaNELat"  type="number" disabled="disabled" />
                    <input id="numberHomeAreaNELon"  type="number" disabled="disabled" /><br />
                </div>
                <div id='divSetHomeArea' class='settingItem'>
                    <label id="labelSetHomeArea"  for="buSetHomeArea">Set Home Area to Screen</label>
                    <input id="buSetHomeArea"  type="button" value="Set" />
                </div>
            </div>
        </div>
        <!-- end of home area -->
        <div id='divSettingsDoneCancel' class='settingItem'>
            <button id="buSettingsDone">Done</button>
            <button id="buSettingsCancel">Cancel</button>
        </div>
    </div>
    
    <!-- Help Guide, only shown when selected from mainMenu -->
    <div id="divHelpGuide" class='wigo_ws_NoShow'>
        <h1>Help - Guide</h1>
        <h2>Title Bar</h2>
        <p>At the top of the screen is a title describing the currently selected map view.</p>
        <ul>
            <li>The <a href="#helpMainMenu">Main Menu</a> is on the left and has several items
            such as Settings and Help.</li>
            <li>The Help symbol ("?") displays this Help - Guide.</li>
            <li>The View DropList on the right selects the <a href="#helpSelectMapView">Map View</a>.</li>
        </ul>    
        <p>The app starts showing the <a href="#helpOnlineMap">Online Map</a>.</p>
        <p>More details about the map views and Main Menu follow.</p>
        <h2 id="helpSelectMapView">Select Map View</h2>
        Select a view from the View droplist on the Title Bar:
        <ul>
            <li><a href="#helpSignInOffBar">Sign-in/off</a> presents the Sign in/off Bar.</li>
            <li><a href="#helpOnlineMap">Online</a> lets you select a trail from ones saved on a web server.</li>
            <li><a href="#helpOfflineMap">Offline</a> lets you view trails when you are 
            not connected to the web. You need to select the trails to save to your phone when 
            you are online.</li>
            <li><a href="#helpDrawTrail">Draw a Trail</a> lets you create a new trail and save it online.</li> 
            <li><a href="#helpEditTrail">Edit a Trail</a> lets you edit a trail that 
            you have saved online.</li> 
        </ul>
        <h2 id="helpSignInOffBar">Sign-in/off Bar</h2>
        <p>If you do not sign in, you can only view public trails created by others.
        However, if you sign in, you can create trails and edit your trails, which can be marked
        as Private for only you to view, or Public for anyone to view.</p>
        If you are not signed in, but need to be to complete an action such as editing, drawing, or finding
        your trails, you are automatically shown the Sign in/off Bar.
        <p>On the left side, the User name is shown when you are signed in. If you are not signed, the User name is blank. 
        You do not type in the User name box, it is filled in automatically when you sign in.</p>
        <p>The Sign-in DropList is shown on the right:
        <ul>
            <li>Select Facebook to sign in.<br/> 
            Your sign-in id is remembered so 
            you do not need to sign in again unless you log out.</li>
            <li>Select Logout to logout of Facebook.<br/>
            Note: Facebook can be tenacious about keeping you logged in. You may need to go
            to Facebook to force a logout.</li> 
        </ul>
        <h2 id="helpOnlineMap">Online Map</h2>
        You can find trails that have been saved online by you or others. The trails you find are in the Trails droplist
        from which you select a trail to view. 
        Also you can select a trail by touching a blue marker on the map that indicates where a trail is. If the markers overlap, 
        touching causes the markers to spread apart so you can select one individually. Touching a marker shows a pop-up
        that shows the trail name and length of the trail. Touch the View Trail button on the pop-up to show the trail on the map.
        <p>Your current geolocation on the trail is shown 
        and you can be alerted if you are off trail. When you are off trail, instructions for returning to the trail
        are shown. The beginning of the trail is indicated by a short green line and the end by a short red line. 
        Also automatic tracking can be enabled to determine if you are off trail.</p>
        <h3>Trails DropList</h3>
        <p>Select a trail from the web that others have made public and ones
        that are private to you.</p>
        <p>Touch the <i>Select a Geo Trail</i> item at the top of the droplist to show the blue markers for trails on the map.</p>
        <p>Touch the <i>Animate Current Trail</i> item, second item in the droplist, to animate the order to travel the trail
        from the beginning to the end. The animation is useful to see the order to travel when a trail has junctions
        or loops. If there is no trail currently selected, the <i>Animate Current Trail</i> item is not in the droplist.</p>
        <h3>Save Offline Button</h3>
        <p>Touch the Save Offline button to save a trail you are viewing so that you can
        view it when you are offline. (See <a href="#helpOfflineMap">Offline Map</a> below.)</p>
        <h3>Find Trails DropList</h3>
        <p>Select an option from the droplist to search for trails to view.
        The Trails droplist is filled with the trails found.</p>
        <ul> 
            <li>Find Trails > Home Area<br/>
            Searches for trails that are in your Home Area, which is a geo-rectangle
            defined in <a href="#helpHomeArea">Menu > Settings > Home Area</a>.
            All public trails and your private trails are included.</li>
            <li>Find Trails > On Screen<br/>
            Searches for trails that are in the area displayed on the screen. 
            First, pan, zoom, and pinch to select the area you see on the screen.</li>
            <li>Find Trails > All Trails<br>
            Searches for all public trails and your private trails.</li>
            <li>Find Trails > All Mine<br/>
            Searches for all your trails, both public and private.
            You must be signed in to search for your trails.</li>
            <li>Find Trails > My Public<br/>
            Searches for all of your public trails, trails that anyone can see.</li>
            <li>Find Trails > My Private<br/>
            Searches for your private trails, trails that only you can see.</li>
        </ul>
        <h3 id="helpOnlineRecord">Record DropList</h3>
        You can record your travel on the map along with your travel time.
        This is useful to keep track of the time and distance for a run.
        Also recording can be helpful if you are trying to return to a trail.<br/>
        Basically you can start, stop, and resume recording a trail. The droplist shows
        the current recording state. Touching the droplist presents options
        to control recording:
        <ul>
            <li>Off State
                <ul>
                    <li>Start<br/>
                    Starts recording and enters On State.
                    </li>
                    <li>Unclear<br/>
                    Restores the recorded trail on the map that has just been cleared.
                    If there is no recorded trail to restore, Unclear is not shown.
                    </li>
                </ul>
            </li>
            <li>On State
                <ul>
                    <li>Stop<br/>
                    Stops recording and enters Stopped State.
                    </li>
                </ul>
            </li>
            <li>Stopped State
                <ul>
                    <li>Save Trail<br/>
                    Saves the recorded trail to the web server. If the recorded trail is 
                    new, enters the TrName State for you to enter a trail name. Otherwise
                    uploads the recorded trail to the web server and remains in the Stopped State.
                    </li>
                    <!-- Append Trail no longer used. Provide insert trail in Edit mode instead
                    <li>Append Trail<br/>
                    Append Trail is only available if you can append the recorded trail
                    to the main trail currently shown. If the main trail shown is not
                    one of your trails, or if there is no main trail shown, 
                    you cannot append the recorded trail.<br/>
                    When Append Trail is available, appends the recorded trail to the
                    main trail, uploads to the server, and remains in the Stopped State.
                    -->
                    <li>Animate Trail<br/>
                    Animates the recorded trail showing the order traveled from the beginning to the end.
                    </li>
                    </li>
                    <li>Show Stats<br/>
                    Shows the distance and run time for the recorded trail. 
                    Remains in the Stopped State.
                    </li>
                    <li>Resume<br/>
                    Resumes recording and enters the On State.
                    </li>
                    <li>Clear<br/>
                    Clears the recorded trail from the map and enters the Off State.
                    </li>
                    <li>Filter<br/>
                    Filters out spurious points for the recorded trail. Sometimes a location
                    can be wildly inaccurate.<br/>
                    </li>
                    <li>Unfilter<br/>
                    Puts back any points that have been removed by filtering.<br/>
                    Option not present if filtering has not been done.
                    </li>
                </ul>
            </li>
            <li>TrName State<br/>
            Enter the name for a new trail in the textbox shown. 
            Also select Public or Private from the Share DropList.
            <ul>
                <li>Upload<br/>
                Uploads the recorded trail to the web server and returns to the Stopped State.
                </li>
                <li>Cancel<br/>
                Does not upload to the server. Returns to the Stopped State.
                </li>
            </ul>
            </li>
        </ul>
        <h3 id="helpControlsAtBottom">Controls at Bottom of Map</h3>
        These controls let you see your current geolocation, turn automatic tracking on or off,
        and turn receiving alerts for your phone on or off.
        <ul>
            <li>Ctr Trail Button<br/>
            Pans the map to the center of the selected trail.</li>
            <li>MyLoc Button<br/>
            Displays your current location on the map. If a trail is selected, checks if you are off trail.</li>
            <li>Track Off | On<br/>
            Switches between geolocation tracking On or Off. 
            When Track is On, checking is done automatically to determine if you are off trail.<br/>
            If Geo Tracking Allowed is No in
            <a href="#helpAllowGeoTracking">Menu > Settings > Allow Geo Tracking</a>,
            Track is not shown.<br/>
            Note: Track On will run down your battery more quickly.</li>
            <li>Alert Off | On<br/>
            Switches between Alert On or Off.
            A phone alert is given if you are off the trail,
            or if recording, each time  you have traveled the alert distance interval.</li>
        </ul>
        <h2 id="helpOfflineMap">Offline Map</h2>
        You select a trail you have saved when you are viewing the Online Map. 
        Offline Map works the same as <a href="#helpOnlineMap">Online Map</a>,
        except that the map is shown from map tiles saved on your phone instead of from the web, 
        which means that the map is limited and is blank if you pan or zoom beyond the bounds
        of the saved map.
       
        <h3>Trails DropList</h3> 
        Select a trail from the list you have saved.
        <h3>Map Cache DropList</h3>
        Shows information about the cache of map tiles.<br/>
        <ul>
            <li>Size<br/>Select to see the number of files and the size in MB of all the files.</li>
            <li>Clear<br/>Select to empty the cache of map files. Clearing the cache deletes all 
            the offline trails from the phone.</li>
        </ul>
        <h3>Record DropList</h3>
        Records a trail as you travel. This works the same as described in 
        <a href="#helpOnlineRecord">Online Record DropList</a>, except 
        the option to save a trail saves locally to the phone instead of
        to the web server.
        <h3>Local Data DropList</h3>
        Manages the data saved locally.<br/>
        <ul>
            <li>Upload<br/>
            Uploads the selected trail to the server. The option is only shown
            if the local trail has not been uploaded to the web server. Also, the
            upload can only be done if there is an Internet connection; if not
            a message is shown to indicate the upload cannot be done.
            </li>
            <li>Delete<br/>
            Deletes the selected trail. The trail is only deleted locally.
            If the trail has been uploaded to the web server, it still remains
            at the web server. Note that the trail can be deleted from the web
            server by going to Edit a Trail available from the View droplist.
            </li>
        </ul>
        <p>The <a href="#helpControlsAtBottom">Controls at Bottom of Map</a> work the same as for the Online Map.</p>
        <h2 id="helpDrawTrail">Draw a Trail</h2>
        <p>Provides a way to create a trail and save it online.</p>
        <p>You must be signed into Facebook to create a trail.</p>
        <p>Instructions are shown at the top of the screen to guide you through the process,
        which is outlined below.</p>
        <ul>
            <li>Enter a name for the trail.</li>
            <li>Share DropList<br/>
            Select Public for anyone to see the trail.<br/>
            Select Private for only you to see the trail.</li>
            <li>Touch on the screen to define the first point on the trail.</li>
            <li>Soft Cursor Keys<br/>
            Use the cursor keys 
            that appear to nudge the point left, right, up, or down to get the point exactly where
            you want it. Holding down a cursor button causes the point to move faster on the screen.
            Touch OK to confirm that the point is to be added. Repeat the process to define
            all the points for your trail.</li>
            <li>Upload Button<br/>
            Touch the Upload button to upload (save online) the data for your trail.</li>
            <li>Cancel Button<br/>
            Touch the Cancel button if you decide not to create the trail.</li>
            <li>Pt Action DropList<br/>
            You can edit an existing point in the trail by selecting Select Pt.
            Touch on the trail near the point you want to edit.<br/>
            <ul>
                <li>Prev, Next Buttons<br/>
                If the correct point is not highlighted on the trail, use 
                the Prev and Next buttons to move to the previous or next point on the trail.</li>
                <li>From the Pt Action droplist select:
                    <ul>
                        <li>Move Pt<br/>
                        When moving a point, touch where the point should go and nudge it with the cursors.
                        Touch OK to confirm that the point is where you want it.</li>
                        <li>Insert Pt<br/>
                        When inserting a point, touch where the inserted point should be and use the cursors to nudge it.
                        Touch OK to confirm the location is correct. The point is inserted in the
                        trail before the selected point.</li>
                        <li>Delete Pt<br/>
                        When deleting a point, confirm the deletion of the point by Touching OK. Use the Prev and Next buttons
                        to move to a different point on the trail if the correct point is not selected (highlighted).</li>
                        <li>Select Pt<br/>
                        If you change your mind about moving, inserting, or deleting a point, Select Pt lets you choose a
                        different point.</li>
                        <li>Append Pt<br/>
                        Choose Append Pt to append a point to the end of the trail instead of editing an existing point.</li> 
                    </ul>
                </li>
            </ul>
            </li>
        </ul>
        <h2 id="helpEditTrail">Edit a Trail</h2>
        <p> Edit provides a way to edit a trail you have saved online.
        The procedure is the same for <a href="#helpDrawTrail">Draw a Trail</a>, 
        except that you select a trail to edit instead of defining a name for the trail.</p>
        <p>You must be signed in to edit a trail, and you can only edit trails that you have defined.</p>
        <h2>Getting Trail Maps from Websites</h2>
        <p>Websites such as Mountain Bike Project (www.mtbproject.com) and
        Hillmap (www.hillmap.com) allow you to download a gpx file from the site for a trail. 
        </p>
        <p>For example, at www.hillmap.com you can create a trail from a laptop or desktop computer:</p>
        <ul>
            <li>Use the Path tab to define your trail.</li>
            <li>Use Tools > Download Gpx to download your path.</li>
        </ul>
        <p>A site may provide a trail in Google's KML format instead of GPX. 
        There are sites that will convert a KML file to a GPX file.</p>
        <p>Use the site www.wigo.ws/geopathsx/gpxpaths.html to upload the path that you have
        downloaded in GPX format so that you can access the path (aka trail) online from GeoTrail.</p>
        <h2 id="helpMainMenu">Main Menu</h2>
        The Main Menu is available from the Title Bar and is the droplist on the left.  
        <h3>Menu > Terms of Use</h3>
        <p>Displays the Terms of Use for this app.
        When the app is first installed or the app is updated, the Terms of Use must be accepted before
        the app can be used. If you do not accept the Terms of Use, uninstall this app.</p>
        <h3 id="helpSettings">Menu > Settings</h3>
        <p>Presents a dialog to set your preferences for the app.</p>  
        <ul>
            <li id="helpAllowGeoTracking">Allow Geo Tracking No | Continuous<span class="noIosHelp"> | Periodic</span><br/>
            For No, geolocation is NOT obtained automatically.
            However, the MyLoc button will still get your geolocation.<br/>
            MyLoc and Track are on the bar of <a href="#helpControlsAtBottom">Controls at Bottom of Map</a>.
            For Track set to On, tracking is enabled. Track set to Off disables tracking.
            However, Track is not on the bar if Allow Geo Tracking is set to No.<br/><br/>
            For Continuous, geolocation is obtained continuously when Track is On.<br/>
            <span class="noIosHelp"><br/>
            For Periodic, geolocation is obtained periodically based on a specified timing interval
            when Track is On.</span>
            <span class='noIosHelp'><br/><br/>
            When the app is in the background (not showing on the screen or screen is turned off), automatic tracking
            still occurs. However, the operating system may stop issuing phone alerts (beeps) if alerts are occurring
            continuously.
            </span>
            <span class='noAndroidHelp'><br/>
            When the app is in the background (not showing on the screen or screen is turned off), automatic tracking
            does NOT occur. The app must must be displayed on the screen for automatic tracking to occurs.            
            </span>
            </li>
            <li>Geo Tracking Update<br/>
            Number of meters to travel before updating the status shown on the phone when Allow Geo Tracking Continuous is selected.
            <br/>
            Geo Tracking Update is only in Settings if Allow Geo Tracking is Continuous.
            </li>
            <li class="noIosHelp">Geo Tracking Interval (secs)<br/>
            Number of seconds to check your geolocation when Allow Geo Tracking Period is selected.
            The geolocation status is shown on the phone periodically after each interval.
            <br/>
            Geo Tracking Interval is only in Settings if Allow Geo Tracking is Periodic.
            <br/>
            The tracking interval should be a long time, say 10 minutes or more. 
            Short time intervals are available mainly for testing.
            If frequent tracking is desired, say every 30 seconds, select Allow Tracking Continuous instead of Periodic
            because it is more accurate and consumes less power. 
            </li>
            <li>Off Trail Threshold<br/>
            Number of meters that you need to be off trail for an alert to be given.</li>
            <li>Distance Units Metric | English<br/></li>
            For Metric, distances are displayed in metric units, e.g. 57m for meters
            or 3.15km for kilometers.<br/>
            For English, distances are displayed in English units, e.g 43ft for feet
            or 1.35mi for miles.
            <li>Allow Phone Alert Yes | No<br/>
            Determines if alerts (beeps) from you phone are given.<br/> 
            Alert is on the bar of <a href="#helpControlsAtBottom">Controls at Bottom of Map</a>.<br/>
            Note: The operating system may stop issuing alerts that are continuously occurring.</li>
            <li>Phone Alert Initially On Yes | No<br/> 
            Yes to start with Alert On when app loads.</li>
            <li>Phone Vibration in Secs<br>
            Number of seconds phone vibrates for an alert. Set to 0 for no vibration.</li>
            <li>Phone Beep Count<br/>
            Number of beeps to give for an alert. Set to 0 for no beepings.</li>
            <li>Record Distance Alert<br/>
            Distance interval for which a phone alert (beep) is given periodically when recording.
            The phone alert occurs each time you have traveled the interval distance.
            Alert on the <a href='#helpControlsAtBottom'>Controls at Bottom of Map</a> must be On for the alert to occur.<br/>
            A value of 0 indicates Record Distance Alert is off (not used). 
            <li>Auto Trail Animation Yes | No<br/>
            Yes automatically animates a trail when it is displayed. 
            If No is selected, the current trail can still be animated by selecting
            the <i>Animate Current Trail</i> item from the Trails droplist.<br/>
            Touching the map stops an animation that is running.</li>
            <li class="noIosHelp">Pebble Watch Yes | No<br/>
            Yes to show messages on a Pebble Watch that is connected to the phone.</li>
            <li class="noIosHelp">Pebble Vibration Count<br/>
            Number of vibrations given on Pebble Watch for message indicating
            off trail. Count of 0 disables vibrations.<br/>
            Note that Alert Off does not inhibit vibrations for being off-trail.</li>
            <li>Prev Geo Loc Thres<br/>
            Number of meters of current geolocation with respect to previous location 
            for change in location to be considered valid. (This prevents small variations in the geolocation of
            the same point to appear to be a change in location.)</li>
            <li>Spurious V Limit<br/>
            The velocity limit in meters/second for a recorded point to be spurious. 
            A point in a recorded trail may be spurious (invalid). If the velocity of point from a previous point
            is too great, the point cannot actually be in the recorded trail and can be filtered out.</li>
            <li>Body Weight<br/>
            Your body weight in pounds or kilograms depending on the Measuring System, English or Metric, chosen.
            Your body weight is used to calculate the number of calories burned traveling while recording a trail.
            </li>
            <li>Calorie Conversion Efficiency<br/>
            Touch Set to change the Calorie Conversion Efficiency.<br/>
            When a trail has been recorded, the time, distance, and speed you traveled are shown.
            Google for a "calories burned calculator" to find a calculator for the actual calories
            you have burned. 
            The time, distance, and speed are typically needed when using the calculator you found along with 
            other factors such as your height, weight, age, and kind of activity.
            Enter the result given by the calculator as the Actual Calories.
            The new calorie conversion efficiency is determined and shown as the New Efficiency.<br/>
            <br/>Touch the Apply button to accept the New Efficiency.<br/>
            <br/>Touch Cancel to not change the efficiency.<br/>
            <br/>Instead, you can set the New Efficiency directly. If there is no recorded trail, the
            only option is to set the New Efficiency.<br/>
            <br>Kinetic Calories give the calculated kinetic energy in calories to move your body mass along the recorded trail.<br/>
            <br/>Estimated Calories are the estimated calories you burned to move along the recorded trail:<br/>
            Estimated Calories =  Kinetic Calories / Current Efficiency.<br/>
            <br/>Calories are in units of US Food Calories:<br/>1 US Food Calorie = 4.184 kiloJoules.
            </li>
            <li>Show Compass Heading on Map?<br/>Yes | No<br/>
            An arrow for the compass heading from your current location may be shown on the map.</li>
            <li>Touch Map for Geo Location Testing?<br/>Yes | No<br/>
            Touching a point on the map simulates getting the geo location for the point on the map.
            This is just for testing.</li>
            <li id="helpHomeArea">Set Home Area to Screen<br>
            Touch the Set button to set your home area to be that shown on the screen<br/>
            First, pan, zoom, and pinch to display the area you want on the screen.<br/>
            The trails in the Home Area are found when the app starts.
            Also, the Home Area can be chosen in Online Map, from the Find Trails droplist.<br/>
            <li>Done Button<br/>
            Touch Done to save the changes and close the Settings dialog.
            <li>Cancel Button<br/>
            Touch Cancel to close the Setting dialog ignoring any changes that may have been made.<br/>
            Note: You must touch Done or Cancel for the dialog to close.</li>
        </ul>
        <div class="noIosHelp">
        <h3>Menu > Start Pebble</h3>
        <p>Starts the Pebble GeoTrail app on your watch. The Pebble GeoTrail app should be started automatically so it is unlikely
        you need to do this.</p>
        <p>However, if you get a message indicating that Pebble is not connected, check the following to try to resolve
        the problem:
        <ul>
            <li>The Pebble app, available from the Google Play Store, needs to be installed on your phone.</li>
            <li>The Pebble GeoTrail app, available from the Pebble Store, needs to be installed on your Pebble watch.</li>
            <li>In your phone Settings, check the following:
                <ul> 
                    <li>Bluetooth is enabled.</li>
                    <li>Your Pebble watch is paired through Bluetooth.</li>
                </ul>
            </li>
            <li>The Pebble app on your phone manages your Pebble watch.
                <ul>
                    <li>Install Pebble GeoTrail on your Pebble watch from your phone.</li>
                    <li>Pair your Pebble watch with your phone (select Manage Pebble).</li>
                </ul>
            </li>
            <li>If your Pebble watch is paired with your phone correctly, you can start Pebble GeoTrail
                from your watch by selecting the Pebble GeoTrail app.<br/>
                Note: This only starts the Pebble GeoTrail app on the your watch and does not 
                start the GeoTrail app on your phone.
            </li>
        </ul>  
        </div>  
        <h3>Menu > Help - Guide</h3>
        Displays a guide (which you are viewing) for using this app.
        <h3>Menu > Help - Back to Trail</h3>
        Display instructions for returning to the trail when you are off the trail. Explains why the instructions 
        may be inaccurate and that you need to use your judgement.
        <div class="noIosHelp">
        <h3>Menu > Help - Tracking vs Battery Drain</h3>
        Explains that automatic tracking causes faster battery drain.
        </div>
        <h3>Menu > About</h3>
        Displays app version number and copyright.
        <h3>Menu > License</h3>
        Displays the open licenses for components used in this app.
        <br/><br/><br/> <!-- Blank line at bottom for fixed close dialog bar to overlay. -->  
    </div>
    <!-- Help Back To Trail, only shown when selected from mainMenu -->
    <div id='divHelpBackToTrail' class='wigo_ws_NoShow'>
        <h1>Help - Back To Trail</h1>
        <p>The instructions for returning to the trail give the heading 
        to return to the nearest point on the trail from your
        current location.</p>
        <p>There are also suggestions to turn from your current traveling direction
        to go back to the trail. While the heading back to the trail is accurate,
        suggestions for turning may not be. Since a turning suggestion may be
        inaccurate, it is prefixed with a "?" mark.</p>
        <p><b>THE TURNS ARE ONLY SUGGESTIONS AND MAYBE WRONG:</b></p>
        <ul>
            <li>One kind of suggestion (?P) is based on the heading from your previous location.
            You may not have traveled in a straight line from your previous location.</li>
            <li>The second kind of suggestion (?C) is based on the compass heading that your phone 
            may be able to provide. The compass heading is the direction your phone indicates 
            you are traveling and is most accurate when you are holding 
            your phone level with its top pointing in the direction you are traveling. 
            The compass may need to be calibrated to show accurately.<br/><br/>
            To calibrate your compass, rotate it three times or so around each axis:<br/>
                <ol>
                    <li>Hold the phone vertically facing you.<br/>
                    Tilt top of phone down and then back up toward you.</li>
                    <li>Rotate top of phone phone left and right keeping the face of phone towards you.</li>
                    <li>Rotate face of phone away and back toward you, keeping the phone vertical.</li>
                </ol>
            </li>
        </ul>        
        <p>To get an accurate turning suggestion from your previous location:</p>
        <ol>
            <li>Touch MyLoc button to get your location.</li>
            <li>Walk in a straight line more than the previous geolocation threshold, typically 40 meters (44 yards).
            The Prev Geo Loc Thres is given in Menu > Settings.</li>
            <li>Touch MyLoc button again to see the off trail distance, return heading, and turning suggestion.</li>
        </ol>
        <p>You can start recording your travel by selecting Record > Start. This draws on the map where you have traveled
        allowing you to compare where you are with respect to the trail.
        <p>Of course, if you know accurate compass directions yourself, follow the heading back to the trail.</p>
        The turning suggestions are only an aid if you do not know accurate compass directions.</p>
        <br/> <!-- space for the Close diaglog bar to overlay -->
    </div>
    <!-- Help Tracking vs Battery Drain, only shown when selected from mainMenu -->
    <div id='divHelpTrackingVsBattery' class='wigo_ws_NoShow noIosHelp'>
        <h1>Help - Tracking vs Battery Drain</h1>
        <p>Menu > Settings > Allow Geo Tracking enables or disables automatic tracking.</p>
        <p>When automatic tracking is enabled, the battery in the phone is drained more quickly.
        The shorter the interval for automatic tracking, the quicker the battery drains. 
        So make the interval longer to reduce the drain on the battery.</p>
        <p>Menu > Settings > Geo Tracking Update sets the distance interval for continuous tracking.</p>
        <p class='noIosHelp'>Menu > Settings > Geo Tracking Interval sets the time interval for periodic tracking. </p>
        <p>Menu > Settings > Allow Geo Tracking No disables automatic tracking,
        which minimizes the battery drain.</p> 
        <p>You can still check your geo location manually by touching
        the MyLoc button on the bottom of the map.
        <span class="noIosHelp"> Also, if using a Pebble watch, the Select (middle) button does the same thing.</span></p>
        <p>The Track control on the bottom of the map lets you toggle automatic tracking On or Off.</p>
        <span class="noIosHelp">
        When this app is in the background (not showing) with automatic tracking Off, the app is not draining the battery.
        However, if the app is in the background with automatic tracking On, the app is draining the battery.</p>
        <p>Note that if the phone screen is turned off (phone not powered totally off, just the screen turned off),
        automatic tracking when On
        is still occurring, which is draining the battery.</p>
        </span>
        <p class='noAndroidHelp'> 
        Automatic tracking does NOT occur if the app is in the background (not showing).</p>
        <p>When automatic tracking is Off, the drain on the battery is minimal.</p>
        <br/> <!-- space for the Close diaglog bar to overlay -->
    </div>
    <!-- Help License, only shown wehn selected from mainMenu -->
    <div id='divHelpLicense' class='wigo_ws_NoShow'>
        <h1>Licenses</h1>
        <p>The main source code for this app is open source licensed under
        the MIT License.</p>
        <p>The open source Cordova / Apache platform can be used to build this mobile app. Refer to
        the Cordova / Apache license.</p>
        <p>Plugins and modules used by the main code have individual open source licenses
        and are listed below. Refer to them individually to determine their kind of license.</p>
        <ul>
        <li>jquery 1-11.3</li>
        <li>Leaflet 0.7.3 for map</li>
        <li>OpenStreetMap.org for map database</li>
        <li>L.TileLayer.Cordova for caching map tiles</li>
        <li>com.jetboystudio.pebble.PebblePGPlugin 0.2.6 "Pebble"</li>
        <li>com.phonegap.plugins.facebookconnect 0.11.0 "Facebook Connect"</li>
        <li>cordova-plugin-compat 1.0.0 "Compat"</li>
        <li>cordova-plugin-device-orientation 1.0.3 "Device Orientation"</li>
        <li>cordova-plugin-dialogs 1.2.1 "Notification"</li>
        <li>cordova-plugin-file 4.2.0 "File"</li>
        <li>cordova-plugin-file-transfer 1.5.1 "File Transfer"</li>
        <li>cordova-plugin-geolocation 2.2.0 "Geolocation"</li>
        <li>cordova-plugin-vibration 2.2.1-dev "Vibration"</li>
        <li>cordova-plugin-whitelist 1.2.2 "Whitelist"</li>
        <li>org.nypr.cordova.wakeupplugin 0.1.0 "WakeupTimer"</li>
        <li>cordova-plugin-network-information 1.3.2 "Network Information"</li>
        <li>github.com/jawj/OverlappingMarkerSpiderfier-Leaflet, May 10, 2016</li>
        <li>github.com/openplans/Leaflet.AnimatedMarker, v1.0.0, December 19, 2016</li>
        </ul>
        <br/> <!-- space for the Close diaglog bar to overlay -->
    </div>

    <!-- Help License, only shown when selected from mainMenu on iPhone. -->
    <div id='divHelpIPhoneLicense' class='wigo_ws_NoShow'>
        <h1>Licenses</h1>
        <p>The main source code for this app is open source licensed under
        the MIT License.</p>
        <p>The Adobe PhoneGap Build website can be used to build this mobile app. Refer to
        the website for its license. Also on a local machine, the open source Cordova / Apache platform 
        should be able to build this mobile app. Refer to the Cordova / Apache license.</p>
        <p>Plugins and modules used by the main code have individual open source licenses
        and are listed below. Refer to them individually to determine their kind of license.</p>
        <ul>
        <li>jquery 1-11.3</li>
        <li>Leaflet 0.7.3 for map</li>
        <li>OpenStreetMap.org for map database</li>
        <li>L.TileLayer.Cordova for caching map tiles</li>
        <li>/Wizcorp/phonegap-facebook-plugin git v0.9.0</li>
        <li>cordova-plugin-dialogs npm v1.1.1</li>
        <li>cordova-plugin-file-transfer npm v1.1.0</li>
        <li>cordova-plugin-geolocation npm v2.4.0</li>
        <li>cordova-plugin-statusbar npm v2.2.0</li>
        <li>cordova-plugin-vibration npm v1.2.0</li>
        <li>org.apache.cordova.device-orientation npm v0.3.11</li>
        <li>github.com/jawj/OverlappingMarkerSpiderfier-Leaflet, May 10, 2016</li>
        </ul>
        <br/> <!-- space for the Close diaglog bar to overlay -->
    </div>

    <!-- Terms of Use, Shown from Help and when installed -->
    <div id='divTermsOfUse' class='wigo_ws_NoShow'>
        <h1>TERMS OF USE</h1>
        <p><b>IF YOU DO NOT AGREE WITH THESE TERMS OF USE, UNINSTALL THIS APP.</b></p>
        <p>This app is released free of charge in the hope that it will be useful.
        However, it is provided without any warranty of any kind; without even the implied warranty of
        usefulness, accuracy, reliability, availability, or free of software defects.</p>
        <b>ADVICE FOR TURNING TO RETURN TO TRAIL MAYBE WRONG</b></p>
        <p>The heading back to the trail should be accurate, but the suggestions for turning back to the trail
        may not be.</p>
        <p>A suggestion for turning to return to the trail starts to a "?" to indicate it may be inaccurate and 
        is only a <b>SUGGESTION TO BE VERIFIED BY YOU</b>. The suggestions for turning my be wrong for various reasons:</p>
        <ul>
            <li>The heading from your previous geolocation is assumed to be a straight line, 
            but you may not have traveled in a straight line.</li>
            <li>The compass may need to be calibrated.</li>
            <li>The compass heading depends on the orientation of your phone. The compass heading (the direction you are traveling)
            is most accurate when you are holding the phone level with its top pointing in the direction you want to travel.</li>
            <li>The geolocation provided by your phone has tolerances for its accuracy.</li>
        </ul>
        <h2>DATA AND PRIVACY</h2>
            <h3>Geolocation</h3>
            <p>Geolocation is used by this app to show your location on a map with respect to a trail that you have selected,
            or to record a trail as you travel. Warnings, which you control, can be shown by the app when your geolocation
            is off the trail you have selected.</p>
            <p>If you choose not to allow this app to use geolocation, the app will not be useful.</p>
            At your option, you may save geolocation data to define a trail on a web server.
            <h3>Web Server Data</h3>
            <p>For trails, that you define manually or record by using geolocation, 
            data is stored on a web server. The data has latitude and longitude for points
            defining the trail. Your Facebook public identifier (not your name) is associated with your trails.
            Protection for the database is provided through access controlled by a password. 
            Data exchanges with the server are encrypted via the https protocol.
            The web hosting company
            provides security against malicious intrusions. However,
            be aware that data could be obtained illegally by hackers or legally by an authorized governmental authority.</p>
            <h3>Data on Your Phone</h3>
            <p>Data is saved on your phone for defining trails and caching map sections when you are offline.
            <p>If from this app you sign in using Facebook, your Facebook public identifier is saved on the phone; 
            when from this app you logout, your identifier is removed.</p>
            <p>The data can be deleted by you from your phone by managing the application on your phone.</p>
            <h3>Making Your Trails Public or Private</h3>
            <p>When you define a trail you mark it as Public or Private. If a trail is Public, it can be seen by anyone
            using this app. If the trail is marked Private, the trail is only visible by you when using the app.
            <h3>Your Data Is Not Shared with Any Other Party</h3>
            As mentioned above, your Facebook public identifier is associated with the 
            geolocation data for a trail you have defined. 
            Marking a trail you save to the web server as Public allows others using this app to view the trail.
            However, neither the geolocation data nor the Facebook public identifier is ever given to another party.
        <h2>A FURTHER CAUTION</h2>
        <p>Hiking depends on your own self reliance and good judgment. Realize that trails you find
        may not be appropriate for your abilities and that the trails could have inaccuracies.</p>
        <br/> <!-- space for the Close diaglog bar to overlay -->
    </div>

    <div id="map-canvas" />   
    <!-- Note: Do not put map-canvas div inside another div or section. -->
</body>
</html>
